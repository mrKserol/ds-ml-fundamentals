# Метрики ранжирования (Ranking Metrics)

В этом разделе рассматриваются метрики качества для задач ранжирования,
поиска и рекомендаций, где модель не принимает бинарное решение,
а упорядочивает объекты по степени релевантности.

Основной фокус — оценка качества выдачи в верхней части списка (top-K),
так как именно эти элементы пользователь видит и с которыми взаимодействует.

---

## Содержимое

### 1) Метрики @K для ранжирования
**Файл:** [ranking_at_k.ipynb](ranking_at_k.ipynb)

В ноутбуке реализованы и разобраны следующие метрики:
- **Recall@K**
- **Precision@K**
- **F1-score@K**
- **Specificity@K**

Метрики рассчитываются вручную на основе:
- предсказанного скора релевантности,
- бинарной исторической реакции пользователя (клик / не клик),
- top-K элементов в выдаче.

---

## Постановка задачи

Рассматривается типичная задача поиска или рекомендаций:
- по запросу пользователя система формирует список объектов,
- каждому объекту присваивается скор релевантности,
- пользователь взаимодействует только с верхней частью выдачи.

Метрики @K позволяют оценивать качество модели
именно в той области, где принимается пользовательское решение.

---

## Ключевые идеи

- В ранжировании модель не предсказывает класс напрямую,
  а формирует упорядоченный список объектов.
- Для оценки качества выдачи top-K интерпретируется
  как положительное предсказание.
- Метрики классификации адаптируются к ранжированию
  через разбиение на top-K и остальные элементы.
- `Recall@K` и `Precision@K` находятся в компромиссном соотношении,
  зависящем от выбранного K.
- `Recall@K` не убывает при увеличении K,
  поэтому сравнение моделей корректно только при фиксированном K.

---

## Визуализация

В ноутбуке используются графики зависимости метрик от K:
- `Recall@K`
- `Precision@K`
- `F1@K`
- `Specificity@K`

Визуализация позволяет наглядно увидеть компромисс
между полнотой и точностью выдачи при изменении K.

---

## Используемые инструменты

- Pandas
- Matplotlib

---

## Практическое замечание

Параметр K является продуктовым:
он определяется тем, сколько результатов пользователь
реально видит и просматривает.

Выбор метрики и значения K должен зависеть
от требований конкретного продукта,
а не от универсального правила.

