# GradientBoostingRegressor

Логика градиентного бустинга реализована вручную; в качестве базового алгоритма используется sklearn.tree.DecisionTreeRegressor.

Реализация предназначена для понимания внутренней логики алгоритма:
обучения базовой модели, вычисления градиента функции потерь и
последовательного добавления деревьев в ансамбль.

---

## Постановка задачи

Целевая переменная — количество дней просрочки по кредиту (`delay_days`).

Несмотря на то, что значения таргета дискретны (целые числа),
задача формулируется как **регрессия**, поскольку:
- значения упорядочены,
- имеет смысл расстояние между ними,
- допустимы операции усреднения.

---

## Реализация модели

Реализован класс `GradientBoostingRegressor` со следующими характеристиками:

- тип задачи: регрессия
- базовый алгоритм: `DecisionTreeRegressor`
- функция потерь: **MSE**
- предсказание базовой модели: среднее значение таргета
- формат предсказаний: `float` (для совместимости со `sklearn`)

### Гиперпараметры
- `n_estimators` — число деревьев в ансамбле
- `learning_rate` — шаг обучения
- `max_depth` — максимальная глубина деревьев
- `min_samples_split` — минимальное число объектов в узле для деления

---

## Проверка корректности

Корректность реализации проверялась следующим образом:

- модель обучалась и тестировалась на одном и том же разбиении данных,
- результаты сравнивались с `sklearn.ensemble.GradientBoostingRegressor`
  при одинаковых гиперпараметрах,
- значения метрик (MSE, MAE) сопоставимы,
  что подтверждает корректность основной логики обучения и предсказаний.

Дополнительно использовались диагностические визуализации:
- scatter-график `y_true` vs `y_pred`,
- распределение ошибок (residuals).

---

## Содержимое папки

- [gradientboosting.py](gradientboosting.py)  
  Реализация `GradientBoostingRegressor`.

- [gradient_boosting_from_scatch.ipynb](gradient_boosting.ipynb)  
  Пошаговое объяснение алгоритма, обучение модели, сравнение со `sklearn`
  и визуальный анализ результатов.

- [users.csv](users.csv)  
  Датасет с признаками и целевой переменной — количеством дней просрочки.

---

## Замечания

Реализация ориентирована на учебные и исследовательские цели.
Для практического использования в продакшене предпочтительны
оптимизированные реализации и методы подбора гиперпараметров.
